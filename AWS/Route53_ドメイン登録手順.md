# Route53_ドメイン登録手順

* ここでは事前に __magenta-magenta.work__ ドメインをお名前.comで購入している
* 購入したドメインをIPアドレスと紐付ける
* Elastic IPアドレスをパブリックIPアドレスに関連付けておく

***

## １．ドメインのネームサーバーをRoute53に変更する

### ホストゾーンを作成する

1. __Route53__ のダッシュボードを開く
2. メニューから __ホストゾーン__ をクリックする
3. __ホストゾーンの作成__ をクリックする
4. 以下の入力と設定をして __ホストゾーンの作成__ をクリックする
    * ドメイン名：magenta-magenta.work
    * タイプ：パブリックホストゾーン
      * パブリックホストゾーン：インターネットから対象ドメインにアクセスする場合
      * プライベートホストゾーン：AWSのVPC内でルーティングする時にドメイン名を指定したい場合

***

## ２．ターミナルからネームサーバーを確認する

### 購入直後の場合、販売元のネームサーバーになっている

1. ターミナルからEC2にログインする
2. コマンドでネームサーバーを確認する

    ```bash
    dig magenta-magenta.work NS +short
    ```

    実行結果

    ```bash
    dns2.onamae.com.
    dns1.onamae.com.
    ```

***

## ３．ネームサーバーを変更する

### お名前.comでドメインのネームサーバーを変更する

反映には24時間～72時間までかかる場合がある

1. お名前.comにログインする
2. ドメイン > ドメイン詳細 > __ネームサーバー設定__ を開く
3. __magenta-magenta.work__ を選択する
4. ネームサーバーの選択で __その他__ タブを開く
5. __その他のネームサーバーを使う__ を選択する
6. ネームサーバーにRoute53で表示されているNSタイプの値をすべて転記する（※末尾の __.__ は不要）
7. __確認__ をクリックする
8. 反映後に上記のコマンドを実行すると、設定されたネームサーバーが表示される

***

## ４．ドメイン名にEC2インスタンスのIPアドレスを紐付ける

### ドメインにAレコードを登録する

1. __Route53__ のダッシュボードを開く
2. メニューから __ホストゾーン__ をクリックする
3. 対象のドメイン名（__magenta-magenta.work__）をクリックする
4. __レコードを作成__ をクリックする
5. 以下の入力と設定をして __レコードを作成__ をクリックする
    * ルーティングポリシー：シンプルルーティング
    * レコード名：空白のまま
    * レコードタイプ：A-IPv4 アドレス
    * エイリアス：いいえ
    * TTL：300
    * 値：Elastic IPアドレスを入力する

***

## ５． Webブラウザでアクセスする

Webブラウザから __magenta-magenta.work__ にアクセスするとApacheのTest Pageが表示される。
