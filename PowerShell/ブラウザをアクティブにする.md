# ブラウザをアクティブにする  

***
## 特定のブラウザをアクティブにする  

* 対象のURLを表示しているIEブラウザをアクティブにする
* 複数起動しているIEブラウザから1つをアクティブにするのではなく、1つだけ起動しているブラウザをアクティブにする
* そのため単独の自動化処理の過程などに使用する
* また、タブを特定してアクティブにすることはできない
```PowerShell
# 対象ページのURL
$url = "https://d4c-lt.com"

# 起動しているブラウザから対象のURLを特定する
$shell = New-Object -ComObject Shell.Application
$ieList = @($shell.Windows() | where { $_.Name  -match "Internet Explorer" })
$ie = @($ieList | where { $_.LocationURL -match $url })[-1]

# HWNDを記憶
$hwnd = $ie.HWND

# 対象のURLを起動しているブラウザをアクティブにする
Add-Type -AssemblyName Microsoft.VisualBasic
$window_process = Get-Process -Name "iexplore" | ? { $_.MainWindowHandle -eq $ie.HWND }
[Microsoft.VisualBasic.Interaction]::AppActivate($window_process.ID)
```
