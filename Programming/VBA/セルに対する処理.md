# セルに対する処理

---

## 値へ変換する

### 指定したセルの範囲（A1:B3）を値のみに変換する

```vb
Option Explicit

Public Sub ChangeToValue()
    With ThisWorkbook.Worksheets("Sheet1").Range("A1:B3")
        .Value = .Value
    End With
End Sub
```

---

## 文字色の変更

### 指定したセルの文字色を変更する

```vb
Option Explicit

Public Sub FontColor()
    ' 自動（黒）に変更
    ThisWorkbook.Worksheets("Sheet1").Cells(1, 1).Font.ColorIndex = xlAutomatic

    ' 赤に変更（ColorIndex=3）
    ThisWorkbook.Worksheets("Sheet1").Cells(1, 2).Font.ColorIndex = 3
End Sub
```

---

## 最終行数の取得

### 使用済みセルの最終行数を取得する

```vb
Option Explicit

Public Sub TestLastRow()
    MsgBox GetLastUsedRow(ActiveSheet)
End Sub

Public Function GetLastUsedRow(ByVal ws As Worksheet) As Long
    With ws.UsedRange
        GetLastUsedRow = .Row + .Rows.Count - 1
    End With
End Function
```

### 特定列（例：A列）の最終行を取得する

```vbnet
Option Explicit

Public Sub TestLastRowInColumn()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Worksheets("Sheet1")

    ' A列の最終行
    MsgBox GetLastRowInColumn(ws, 1)

    ' 例：C列の最終行
    ' MsgBox GetLastRowInColumn(ws, 3)
End Sub

Public Function GetLastRowInColumn(ByVal ws As Worksheet, ByVal col As Long) As Long
    GetLastRowInColumn = ws.Cells(ws.Rows.Count, col).End(xlUp).Row
End Function
```