# シートに対する処理

---

## シートの追加と削除

### シートを末尾に追加する

```vb
Option Explicit

Public Sub AddSheet()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Worksheets.Add(After:=ThisWorkbook.Worksheets(ThisWorkbook.Worksheets.Count))
End Sub```

### シートを削除する

```vb
Option Explicit

Public Sub DelSheet()
    ' 確認ダイアログを出さずに削除したい場合:
    ' Application.DisplayAlerts = False
    ThisWorkbook.Worksheets("シート名").Delete
    ' Application.DisplayAlerts = True
End Sub
```

### シート名を指定して追加する

* シート名の重複エラーを回避するために時分秒を付与している

```vb
Option Explicit

Public Sub AddNamedSheet()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Worksheets.Add(After:=ThisWorkbook.Worksheets(ThisWorkbook.Worksheets.Count))

    ws.Name = "シート名_" & Format$(Now, "hhmmss")
End Sub
```

---

## シートの別ファイル保存

### アクティブなシートを別ファイルに保存する

```vb
Option Explicit

Public Sub SheetSave()
    Dim sheetName As String
    sheetName = ActiveSheet.Name

    ActiveSheet.Copy
    ActiveWorkbook.SaveAs Filename:=ThisWorkbook.Path & Application.PathSeparator & sheetName & ".xlsx"
    ActiveWorkbook.Close SaveChanges:=False
End Sub
```

---

## シートの存在チェック

### シート名（Sheet1）が存在するかチェックしてメッセージボックスで表示する

```vb
Option Explicit

Public Sub SheetNameCheck()
    Dim ws As Worksheet

    For Each ws In ThisWorkbook.Worksheets
        If ws.Name = "Sheet1" Then
            MsgBox "存在します"
            Exit Sub
        End If
    Next ws

    MsgBox "存在しません"
End Sub
```
