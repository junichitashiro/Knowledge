# 年月日の取得と表示

---

## 補足：欲しい値と使うべき関数の方針

* 日付だけ → Date
* 日付＋時刻 → Now
* 加算・減算 → DateAdd
* 月末・月跨ぎ → DateSerial
* 表示形式 → Format

---

## 現在日から「年月日」を取得する

```vb
Option Explicit

Public Sub DateConvertYMD()
    Dim ymd As Date
    ymd = Date
    MsgBox ymd
End Sub
```

### 実行結果

> 2026/01/17

---

## 翌日・昨日を取得する（月跨ぎ対応）

```vb
Option Explicit

Public Sub TomorrowAndYesterday()
    MsgBox DateAdd("d", 1, Date)   ' 翌日
    MsgBox DateAdd("d", -1, Date)  ' 昨日
End Sub
```

### 実行結果

> 2026/01/18  
  2026/01/16

---

## 先月末・今月末・翌月末を取得する

### 日付に0を指定することで先月末日を取得する

```vb
Option Explicit

Public Sub EndOfEachMonth()
    MsgBox DateSerial(Year(Date), Month(Date), 0)        ' 先月末
    MsgBox DateSerial(Year(Date), Month(Date) + 1, 0)    ' 今月末
    MsgBox DateSerial(Year(Date), Month(Date) + 2, 0)    ' 翌月末
End Sub
```

### 実行結果

> 2025/12/31  
  2026/01/31  
  2026/02/28

---

## 年月日の表示形式を指定する

### 年月日のフォーマット例

```vb
Option Explicit

Public Sub FormatYMD()
    MsgBox Format$(Date, "yyyymmdd")
    MsgBox Format$(Date, "yyyy/mm/dd")
    MsgBox Format$(Date, "yyyy年mm月dd日")
End Sub
```

### 実行結果

> 20260117  
  2026/01/17  
  2026年01月17日
