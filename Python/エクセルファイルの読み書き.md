# エクセルファイルの読み書き  

* 使用する外部ファイル等は __sample_file__ 参照

***

## エクセルファイルの読み込み  

* エクセルファイルを読み込む

```python
# -*- coding:utf-8 -*-
import xlrd

workbook = xlrd.open_workbook('test.xlsx')
sheet1 = workbook.sheet_by_index(0)

for col in range(sheet1.ncols):
  for row in range(sheet1.nrows):
    cell_value = sheet1.cell(row, col).value
    print(cell_value)
```

* 実行結果

> A1  
A2  
A3  
エクセル  
B1  
B2  
B3  
読み込み  
C1  
C2  
C3  
テスト  

***

## 特定のセルを読み込む  

* 読み込むセルのアドレス情報を外部ファイルから読み込む
* 外部ファイルにはカンマ区切りで行、列を記載する

```python
# -*- coding:utf-8 -*-
import xlrd

address_txt = 'address.txt'
cell_address = []
value_list = []
workbook = 'test.xlsx'
book = xlrd.open_workbook(workbook)
sheet = book.sheet_by_name('Sheet1')

# address.txtからセル情報を読み込む
f =open(address_txt, 'r')
for cell in f:
  # 参照するセルのアドレス情報をcell_addressに格納する
  cell_address = cell.strip().split(',')
  # cell_addressをもとに参照した値をvalue_listに格納する
  value_list.append(sheet.cell(int(cell_address[0]), int(cell_address[1])).value)
f.close()

print(str(value_list))
```

* address.txtの中身

```txt
0,0
1,0
2,0
3,0
```

* 実行結果

> ['A1', 'A2', 'A3', 'エクセル']
