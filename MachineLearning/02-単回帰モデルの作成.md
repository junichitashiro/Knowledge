## 単回帰モデルの作成

ここでは[SIGNATEの練習問題データ](https://signate.jp/competitions/24/data)を使用している

## 単回帰モデルの概要
* 1つの目的変数を1つの説明変数のみでモデル化する方法
* 散布図の中に、各データそれぞれに対するちょうどよい直線を引くイメージ
* __y = ax + b__ の数式で表すことができる

## モデリングの手順

1. 説明変数の決定とデータの準備
    * どのデータを使ってモデルを作るかを決める
    * 欠損値の前処理をする
    * 学習データから説明変数と目的変数を抽出する
    * 評価データから説明変数を抽出する

2. モデルの準備
    * どの手法を使ってモデルを作るかを決める

3. モデルの作成
    * 学習データから取り出した説明変数と目的変数のデータを使ってモデルを作成する

4. モデルを使った予測
    * 評価データから抽出した説明変数のデータを使い、作成したモデルに当てはめる

5. モデルの評価
   * 評価データに対するモデルの予測結果と実際の値を比較して評価する
   * モデルの評価関数

    |評価関数|予測対象|使用例|値域|見方|
    |:--:|--|:--:|:--:|--|
    |AUC|分類精度を測る|医療診断|0-1|値が大きいほど良い|
    |LogLoss|分類精度を測る|画像分類|0-∞|値が小さいほど良い|
    |Accuracy|分類精度を測る|画像分類|0-1|値が大きいほど良い|
    |Precision|正確性を測る|検索エンジン|0-1|値が大きいほど良い|
    |Recall|カバー率を測る|検索エンジン|0-1|値が大きいほど良い|
    |MAE|誤差を測る|需要予測|0-∞|値が小さいほど良い|
    |RMSE|誤差を測る|需要予測|0-∞|値が小さいほど良い|
    |MAP@n|検出精度を測る|推薦エンジン|0-1|値が大きいほど良い|
    |nDCG|ランキング精度を測る|推薦エンジン|0-1|値が大きいほど良い|

## 説明変数の決定とデータの準備
* ライブラリのインポート
* __LinearRegression__ は線形回帰用のライブラリ
  ```python
  import pandas as pd
  import numpy as np
  from matplotlib import pyplot as plt
  %matplotlib inline
  from sklearn.linear_model import LinearRegression as LR
  ```

* CSVデータの読み込み
  ```python
  train = pd.read_csv("train.csv")
  test = pd.read_csv("test.csv")
  sample = pd.read_csv("sample.csv",header=None)
  ```

* 欠損値を確認する
  ```python
  train.isnull().sum()
  test.isnull().sum()
  ```

* 学習データから説明変数と目的変数を抽出する
  ```python
  trainX = train["temperature"]
  y = train["y"]
  ```

* 評価データから説明変数を抽出する
  ```python
  testX = test["temperature"]
  ```

* 説明変数を合わせるためにデータの整形をする
  ```python
  trainX = trainX.values.reshape(-1,1)
  testX = testX.values.reshape(-1,1)
  ```

## モデルの準備
* モデルを表す変数を用意する
  ```python
  model1 = LR()
  ```

## モデルの作成
* fit関数（説明変数、目的変数の順に指定）でモデルを作成する
  ```python
  model1.fit(trainX,y)
  ```

* モデルの傾きと切片を確認する
  ```python
  model1.coef_
  model1.intercept_
  ```

## モデルを使った予測
* predict関数を使った予測結果を変数に代入する
  ```python
  pred = model1.predict(testX)
  ```

## モデルの評価
* SIGNATEで評価する形式にデータを加工する
* sampleファイルのカラム[1]に、予測結果を代入する
  ```python
  sample.head()

  sample[1] = pred
  ```

* sampleをCSVファイルに書き出す
  ```python
  sample.to_csv("submit1.csv",index=None,header=None)
  ```

* 書き出したファイルを[SIGNATE](https://signate.jp/competitions/24/data)に投稿して評価を確認する
