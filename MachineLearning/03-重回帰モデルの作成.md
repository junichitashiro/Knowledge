# 重回帰モデルの作成

ここでは[SIGNATEの練習問題データ](https://signate.jp/competitions/24/data)を使用している

## 重回帰モデルの概要
* 2つ以上の目的変数を使った回帰モデル
* __y = ax1 + bx2 + cx3 + …__ の数式で表すことができる

## 説明変数の決定とデータの準備
* ライブラリのインポート
* __LinearRegression__ は線形回帰用のライブラリ
  ```python
  import pandas as pd
  import numpy as np
  from matplotlib import pyplot as plt
  %matplotlib inline
  from sklearn.linear_model import LinearRegression as LR
  ```

* CSVデータの読み込み
  ```python
  train = pd.read_csv("train.csv")
  test = pd.read_csv("test.csv")
  sample = pd.read_csv("sample.csv",header=None)
  ```

* 質的データの列をダミー変数化する
  ```python
  pd.get_dummies(train["week"]
  ```

* 学習データから説明変数と目的変数を抽出する
  ```python
  trainX = pd.get_dummies(train[["week","temperature"]])
  y = train["y"]
  ```

* 評価データから説明変数を抽出する
  ```python
  testX = pd.get_dummies(test[["week","temperature"]])
  ```

## モデルの準備
* モデルを表す変数を用意する
  ```python
  model = LR()
  ```

## モデルの作成
* fit関数（説明変数、目的変数の順に指定）でモデルを作成する
  ```python
  model.fit(trainX,y)
  ```

* モデルの傾きと切片を確認する
  ```python
  model.coef_
  model.intercept_
  ```

* predict関数を使った予測結果を変数に代入する
  ```python
  pred = model.predict(testX)
  ```

## モデルの評価
* SIGNATEで評価する形式にデータを加工する
* sampleファイルのカラム[1]に、予測結果を代入する
  ```python
  sample.head()

  sample[1] = pred
  ```

* sampleをCSVファイルに書き出す
  ```python
  sample.to_csv("submit.csv",index=None,header=None)
  ```

* 書き出したファイルを[SIGNATE](https://signate.jp/competitions/24/data)に投稿して評価を確認する
