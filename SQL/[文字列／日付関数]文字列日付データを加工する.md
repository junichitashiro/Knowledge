# [文字列/日付関数]文字列日付データを加工する  

* 関数を利用して文字列や日付を加工して取り出す
* データベース製品に依存する部分が多くあり、アプリケーションの汎用性のためにもこれらの操作はSQLではなくアプリケーションで行うべきである

***

* 書籍情報テーブル（books）からISBNコード、書名、刊行日を取り出す
* ISBNコードの頭に固定文字列「ISBN」を付加する
* 刊行日の形式は「YYYY年MM月DD日」とする

```sql
SELECT CONCAT('ISBN',isbn) AS ISBNコード,title AS 書名,
DATE_FORMAT(publish_date,'%Y年%m月%d日') AS 刊行日 FROM books;
```

* アンケート回答テーブル（quest）から都道府県別の評価の平均値を求める
* 平均値は小数点以下を四捨五入する

```sql
SELECT prefecture AS 都道府県,ROUND(AVG(answer1)) AS 評価平均
FROM quest GROUP BY prefecture;
```

* 貸し出し記録テーブル（rental）から未返却の書籍情報を貸出日について昇順で抽出する
* 取得列と別名はisbn:ISBNコード、rental_date:貸出日（YY/MM/DD）とする

```sql
SELECT isbn AS ISBNコード,DATE_FORMAT(rental_date,'%y/%m/%d') AS 貸出日
FROM rental WHERE returned=0 ORDER BY rental_date ASC;
```

* ユーザテーブル（usr）から利用者（氏名）と完全な住所を取り出し、利用者コードで降順に並べる

```sql
SELECT CONCAT(l_name,f_name) AS 利用者名,CONCAT(prefecture,city,o_address) AS 住所
FROM usr ORDER BY user_id DESC;
```

* 書籍情報テーブル（books）から出版社ごとの書籍価格の平均値（小数点以下切捨て）を求める

```sql
SELECT publish AS 出版社,FLOOR(AVG(price)) AS 平均価格
FROM books GROUP BY publish;
```

* 社員テーブル（employee）から氏名を取り出し、部署、役職ごとに降順で並べる

```sql
SELECT depart_id AS 部署,class AS 役職,CONCAT(l_name,f_name) AS 氏名
FROM employee ORDER BY depart_id DESC,class DESC;
```
