# Route53_ドメイン登録手順

* ここでは事前に **magenta-magenta.work** ドメインをお名前.comで購入している
* 購入したドメインをIPアドレスと紐付ける
* Elastic IPアドレスをパブリックIPアドレスに関連付けておく

---

## １．ドメインのネームサーバーをRoute53に変更する

### ホストゾーンを作成する

1. Route53ダッシュボードを開く
2. ホストゾーン画面を開く
3. ホストゾーンの作成に進む
4. 以下の設定をしてホストゾーンを作成する
    * ドメイン名：magenta-magenta.work
    * タイプ：パブリックホストゾーン
      * パブリックホストゾーン：インターネットから対象ドメインにアクセスする場合
      * プライベートホストゾーン：AWSのVPC内でルーティングする時にドメイン名を指定したい場合

---

## ２．ターミナルからネームサーバーを確認する

### 購入直後の場合、販売元のネームサーバーになっている

1. ターミナルからEC2にログインする
2. コマンドでネームサーバーを確認する

    ```bash
    dig magenta-magenta.work NS +short
    ```

    実行結果

    ```bash
    dns2.onamae.com.
    dns1.onamae.com.
    ```

---

## ３．ネームサーバーを変更する

### お名前.comでドメインのネームサーバーを変更する

反映には24時間～72時間までかかる場合がある

1. お名前.comにログインする
2. ネームサーバーの設定画面を開く
3. **magenta-magenta.work** を選択する
4. ネームサーバーの選択でその他のネームサーバーを選択する
5. ネームサーバー情報にRoute53で表示されているNSタイプの値をすべて転記する（※末尾の **.** は不要）
6. 設定を反映させる
7. 反映後に上記のコマンドを実行すると、設定されたネームサーバーが表示される

---

## ４．ドメイン名にEC2インスタンスのIPアドレスを紐付ける

### ドメインにAレコードを登録する

1. Route53ダッシュボードを開く
2. ホストゾーン画面を開く
3. 対象ドメイン名（**magenta-magenta.work**）のリンクを開く
4. レコードの作成に進む
5. 以下の設定をしてレコードを作成する
    * レコード名：空白のまま
    * レコードタイプ：A-IPv4 アドレス
    * エイリアス：不要
    * 値：Elastic IPアドレスを入力する
    * TTL：300
    * ルーティングポリシー：シンプルルーティング

---

## ５． Webブラウザでアクセスする

Webブラウザから **magenta-magenta.work** にアクセスするとApacheのTest Pageが表示される。
