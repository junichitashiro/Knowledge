# AWSアカウント作成後の初期設定手順

## １．料金を使いすぎないための設定をする

### 通貨を日本円に設定する

1. アカウント名をクリックして __アカウント__ を開く

2. __お支払い通貨の設定__ の編集をクリックする

3. __お支払い通貨の選択:JPY - Japanses Yen__ を選択する

4. __更新ボタン__ をクリックする

***

### 請求アラートの受信設定をする

1. アカウント名をクリックして __請求ダッシュボード__ を開く

2. 左メニューの設定カテゴリから __請求設定__ を開く

3. 基本的にどの情報も受け取れるようにチェックを入れておく
    * E メールで PDF 版請求書を受け取る
    * 無料利用枠の使用のアラートの受信
      * E メールアドレスに受信アドレスを入力する
    * 請求アラートを受け取る

4. __保存ボタン__ をクリックする

***

### 料金アラートを設定する

使用料金が10ドルを超えた場合のアラームを作成する

#### ステップ1 メトリクスと条件の指定

1. __CloudWatch__ の画面を開く

2. リージョンを __バージニア北部__ に切り替える

3. アラームメニューを開き __すべてのアラーム__ をクリックする

4. __アラームの作成__ をクリックする
    * __メトリクスの選択__ をクリックする
    * 参照タブから __請求__ をクリックする
    * __概算合計請求額__ をクリックする
    * __USD・EstimatedCharges__ にチェックを入れる
    * __メトリクスの選択__ をクリックする

5. 条件の設定で以下の選択をして __次へ__ 進む
    * 静的
    * より大きい
    * 10USD

#### ステップ2 アクションの設定

* アクションの設定で以下の選択をして __次へ__ 進む
  * アラーム状態トリガー：__アラーム状態__
  * SNS トピックの選択：__既存の SNS トピック__ を選択する
    * 通知の送信先：__Default_CloudWatch_Alarms_Topic__ を設定する
  * 既存がない場合は __新しいトピックの作成__ から作成する

* SNSトピックの補足
  * SNSトピックというのは __Amazon Simple Notification Service__ という通知用サービスにおけるトピックを指す
  * CloudWatchでアラートを設定する際、実際のメール通知はAmazon SNSが行う

#### ステップ3 名前と説明を追加

* アラーム名と、必要があれば説明を入力して __次へ__ 進む

#### ステップ4 プレビューと作成

* これまでの設定を確認して __アラームの作成__ をクリックする

***

## ２．作業用ユーザーを作成する

### IAMユーザーの請求情報アクセスを許可しておく

rootユーザー以外でも請求情報が見えたほうが便利なため

1. アカウント名をクリックして __アカウント__ を開く

2. __IAM ユーザー/ロールによる請求情報へのアクセス__ の編集ボタンをクリックする

3. __IAM アクセスのアクティブ化__ にチェックを入れて更新する

***

### ユーザーを追加する

[IAM_ユーザー追加手順](https://github.com/junichitashiro/Technical-Notes/blob/master/Cloud/AWS/IAM_ユーザー追加手順.md) に従ってユーザーグループとユーザーを追加する

一通りの環境構築が可能な権限が必要になるので __アクセス許可の設定__ については下記の設定にする

* 『ユーザーをグループに追加』ではなく __『既存のポリシーを直接アタッチ』__ を選択する
* ポリシー名の __AdministratorAccess__ にチェックを入れる

***

## ３．操作ログの記録期間を変更する

__CloudTrail__ ではデフォルトで証跡を保存しているが90日までとなっている  
以下の設定で保存場所を __S3__ に変更することで永久的な保存に変える  
しかし __S3は有料であり、個人利用なら必須ではない__

1. __CloudTrail__ の画面を開く

2. __証跡の作成__ をクリックする

3. 証跡名を入力する

4. __証跡情報を全てのリージョンに適用__ で __はい__ を選択する

5. 管理イベントの __読み込み/書き込みイベント__ で __すべて__ を選択する

6. データイベントの __S3__ タブで __アカウントのすべての S3 バケットの選択__ にチェックを入れる

7. ストレージの場所の __新しい S3 バケットを作成しますか__ で __はい__ を選択する
    * S3バケットはS3のフォルダ名のようなもの

8. S3バケットを入力する
    * S3バケット名はグローバルでユニークにする必要がある

9. __作成__ をクリックする

10. 左メニューの __証跡情報__ をクリックして証跡が作成されていることを確認する
