# データ分析の事前準備

ここでは[SIGNATEの練習問題データ](https://signate.jp/competitions/24/data)を使用している

## よく使うPythonのライブラリ
#### numpy
* 演算用ライブラリ
* 行列の形式で演算できるため処理速度が早い
* numpyの形式が他の機械学習用ライブラリの前提になっている場合もある

#### matplotlib
* データを可視化するためのライブラリ

#### pandas
* データ前処理用のライブラリ
* データのラベル付けや不要列の削除などに用いる

#### 一般的な処理の流れ
1. pandasで前処理
2. numpyで演算
3. matplotlibで可視化

## データを読み込む
* ライブラリのインポート
  ```python
  import pandas as pd
  import numpy as np
  from matplotlib import pyplot as plt
  import japanize_matplotlib
  %matplotlib inline
  ```

* CSVデータの読み込み
  ```python
  train = pd.read_csv("train.csv")
  ```

## 概要を見る
* 行数と列数を確認する
  ```python
  train.shape
  ```

* 先頭行と最終行を見る
  ```python
  train.head()
  train.head(10)

  train.tail()
  ```

## 詳細を見る
* 基本統計量を確認する
  ```python
  train.describe()
  ```

* データの型を確認する
  ```python
  train.info()
  ```

* 特定の列だけ見る
  ```python
  train["y"]
  train[["y","week"]]
  ```

* 特定の列の平均値と中央値を見る
  ```python
  train["y"].mean()
  train["y"].median()
  ```

* 特定の列の条件に合致する行だけを見る
  ```python
  train[train["y"]>=150]
  train[train["week"]=="月"]
  ```

* 特定の列の条件に合致した行の平均値を見る
  ```python
  train[train["week"]=="月"]["y"].mean()
  test[test["temperature"]>=test["temperature"].mean()]
  ```

* 昇順・降順で見る
  ```python
  train[train["week"]=="火"].sort_values(by="y")
  train[train["week"]=="火"].sort_values(by="y",ascending=False)
  ```

## 折れ線グラフにして見る
* グラフを描く
  ```python
  train["y"].plot()
  train["y"].plot(figsize=(12,4))
  ```

* グラフと軸に名前を付ける
  ```python
  ax = train["temperature"].plot(title="気温")
  ax.set_xlabel("time")
  ax.set_ylabel("temperature")
  ```

## ヒストグラムにして見る
* ヒストグラムを描く
  ```python
  train["y"].plot.hist()
  ```

* グリッド線を引く
  ```python
  train["y"].plot.hist(grid=True)
  ```

* 平均値を表す赤線を描く
  ```python
  plt.axvline(x=train["y"].mean(),color="red")
  train["y"].plot.hist()
  ```

* 大きさを変えて画像データとして出力する
  ```python
  plt.axvline(x=train["y"].mean(),color="red")
  train["y"].plot.hist(figsize=(12,4),title="ヒストグラム")
  plt.savefig("sample_fig.png")
  ```

## 欠損値を確かめる
* 欠損値が含まれているか確かめる
  ```python
  train.isnull()
  ```

* 欠損値が含まれている列を表示する
  ```python
  train.isnull().any()
  ```

* 欠損値の数を表示する
  ```python
  train.isnull().sum()
  ```

* 特定の列の値がそれぞれいくつあるか表示する
  ```python
  train["precipitation"].value_counts()
  ```

## 欠損値を処理する
* 欠損値を0で補間する
  ```python
  train.fillna(0)
  ```

* 欠損値を含む行を削除する
  ```python
  train.dropna()
  ```

* 特定の列に欠損値があった場合その行を削除する
  ```python
  train.dropna(subset=["kcal"])
  ```

* 平均値で欠損値を補間する
  ```python
  avg = train["kcal"].mean()
  train["kcal"].fillna(avg)
  ```

## 相関係数を調べる
* 指定した2つの列の相関係数を調べる
  ```python
  train[["y","temperature"]].corr()
  ```

## 散布図で確かめる
* 指定した2つの列の散布図を見る
  ```python
  train.plot.scatter(x="temperature",y="y",figsize=(5,5))
  ```
