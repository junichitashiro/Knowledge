# CentOS7の環境構築手順  

* 作業アカウント：vagrant
* 各種パッケージのバージョンは動作確認できたものを記載

***

## yum のリポジトリサーバのドメインを指定する  

* 国内サーバを指定して高速化を図る

```bash
sudo sed -i '/#include_only=/a include_only=.JP' /etc/yum/pluginconf.d/fastestmirror.conf
sudo yum clean all
```

* 手動の場合

```bash
sudo vi /etc/yum/pluginconf.d/fastestmirror.conf
# --------------------------------------------------
# 以下の指定をする
include_only=.JP
# --------------------------------------------------
sudo yum clean all
```

***

## Gitのセットアップ準備  

* 古いバージョンの削除と開発用パッケージのインストール

```bash
sudo yum -y remove git
sudo yum -y install curl-devel expat-devel gettext-devel openssl-devel zlib-devel perl-ExtUtils-MakeMaker autoconf
```

* 新しいバージョンのGitをインストール

```bash
# Gitの取得　必要なバージョンを指定すること
sudo wget https://www.kernel.org/pub/software/scm/git/git-2.23.0.tar.gz
# 取得したファイルの展開
sudo tar vfx git-2.23.0.tar.gz
cd git-2.23.0
# インストールの事前チェックとコンパイル
sudo make configure
sudo ./configure --prefix=/usr
sudo make all
# インストールの実行
sudo make install
```

***

## GitHubからセットアップシェルを取得  

* Git用のディレクトリを作成してリポジトリを取得

```bash
mkdir ~/git
cd ~/git
git clone https://github.com/junichitashiro/ShellScript.git
```

* セットアップシェルを実行する

```bash
cd ShellScript
./centos7_initial_setup.sh
```

* システムを最新化

```bash
sudo yum -y update
```

* 鍵の不一致で最新化できない場合鍵を取得しなおす

```bash
curl -L https://yum.puppetlabs.com/RPM-GPG-KEY-puppet -o /tmp/RPM-GPG-KEY-puppet
gpg --with-fingerprint "/tmp/RPM-GPG-KEY-puppet"
sudo cp /tmp/RPM-GPG-KEY-puppet /etc/pki/rpm-gpg/RPM-GPG-KEY-puppetlabs-PC1
```
