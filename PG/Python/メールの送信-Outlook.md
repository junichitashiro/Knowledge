# メールの送信

* Outlookでメールを送信する

***

## win32comのインストール

* pipからwin32comをインストールする

  ```cmd
  pip install pywin32
  ```

***

## メール作成と送信

* 作成したメールを表示して手動で送信する場合 __mail.display(True)__ をコメントインする
* 確認せずそのまま送信する場合 __mail.Send()__ をコメントインする
* 宛先は __;__ 区切りで複数指定することができる

  ```python
  # ----------------------------------------
  # モジュールのインポート
  # ----------------------------------------
  import win32com.client


  # ----------------------------------------
  # Outlookオブジェクトの設定
  # ----------------------------------------
  outlook = win32com.client.Dispatch('Outlook.Application')
  mail = outlook.CreateItem(0)


  # ----------------------------------------
  # メール内容の設定
  # ----------------------------------------
  # 署名
  sign = '''
  '''
  mail.bodyformat = 1  # 1:テキスト 2:HTML 3:リッチテキスト
  mail.to = ''
  mail.cc = ''
  mail.bcc = ''
  mail.subject = '件名'
  mail.body = '''
  メール本文
  ''' + '\n' + sign


  # ----------------------------------------
  # 添付ファイルの設定
  # ----------------------------------------
  # 添付ファイルの絶対パス
  add_file1 = 'C:\\...\\...\\file.txt'
  mail.attachments.Add(add_file1)

  # 必要に応じて増やす
  # add_file2 = ''
  # mail.attachments.Add(add_file2)


  # ----------------------------------------
  # メールを送信する
  # ----------------------------------------
  # mail.display(True)
  mail.Send()
  ```
